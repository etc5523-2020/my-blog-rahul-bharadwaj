---
title: "COVID-19 in South Africa"
description: |
  A data story of COVID-19 in South Africa
author:
  - name: Rahul Bharadwaj
    url: https://rahul-bharadwaj.github.io/My-Portfolio/
    affiliation: Monash University
date: 09-04-2020
output:
  distill::distill_article:
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.align = "center")
library(tidyverse)
library(here)
library(reactable)
library(DT)
library(ggpubr)
library(kableExtra)
```

# **Introduction -**

Covid-19 has dropped a bombshell out of the blue and caught the world unaware. It has negatively impacted the lives of millions and proved fatal to thousands of others. With over 25 million cases and 800K deaths around he globe as of Sep 2020, this has been a serious issue of concern for the Governments of all the countries. Amidst the pandemic, this is the story of how South Africa was affected by it. This blog story helps understand the Covid situation in SA.

# **Data Description -**

```{r ReadData}
covidSA <- COVID19::covid19(country = "South Africa", verbose = FALSE)
```

* The data used for this blog story is obtained from: **Guidotti, E., Ardia, D., (2020), "COVID-19 Data Hub", Journal of Open Source Software 5(51):2376, doi: 10.21105/joss.02376**, through the R package "COVID19" and filtered for the country South Africa.

* Date ranges from `r min(covidSA$date)` to `r max(covidSA$date)`. **It consists of the following columns:**

```{r columns}
datatable(as.tibble(names(covidSA)))
```

* The following table consists of the **columns of interest and thor values**.

```{r wrangling}
covidSA %>% select(date, tests, confirmed, recovered) %>% reactable(highlight = TRUE)
```

* The above table is interactive and can be used to get an overview of the data. Specifics like when the testings started, when the first case was confirmed, how many recovered, and how many had died can be determined by exploring the table. Click on 'Next' to explore all 225 rows.

# **Data Story -**

* Testing in South Africa seems to have started on 11 Feb 2020. The first confirmed case was on 05 Mar 2020. The first fatality due to Covid was on 22 Mar 2020. All of this is inferred from briefly having a look at the interactive table.

* Let us have a look at these timelines.

```{r plot1, fig.cap='Covid Timeline in South Africa'}
covidSA %>% ggplot() +
  geom_path(aes(x = date, y = tests, color = "tested")) +
  geom_path(aes(x = date, y = confirmed, color = "confirmed")) +
  geom_path(aes(x = date, y = recovered, color = "recovered")) +
  geom_path(aes(x = date, y = deaths, color = "deaths")) +
  xlab("Date") + ylab("Attribute Counts") + ggtitle("Timeline Curves for Covid in SA") +
  theme_bw()
```

* As inferred from the table, tests have begun far before the first case was confirmed. We can see a close relation with the number of people recovered with the confirmed cases. The death rate seems to be low in this plot. It will be a good idea to view each attribute seperately to get a better picture.

```{r plot2, fig.cap='Comparing Tests, Cases, Recoveries, and Deaths'}
test <- covidSA %>% ggplot() +
  geom_line(aes(x = date, y = tests)) +
  xlab("Date") + ylab("Tests") + ggtitle("Number of Tests for Covid in SA") +
  theme_bw()

conf <- covidSA %>% ggplot() +
  geom_path(aes(x = date, y = confirmed)) +
  xlab("Date") + ylab("Tests") + ggtitle("Confirmed Covid cases in SA") +
  theme_bw()

reco <- covidSA %>% ggplot() +
  geom_path(aes(x = date, y = recovered)) +
  xlab("Date") + ylab("Tests") + ggtitle("Recovered Covid cases in SA") +
  theme_bw()

deat <- covidSA %>% ggplot() +
  geom_path(aes(x = date, y = deaths)) +
  xlab("Date") + ylab("Deaths") + ggtitle("Deaths due to Covid in SA") +
  theme_bw()

ggarrange(test, conf, reco, deat)
```
* Totals for each attribute in SA:

  + Total Tests - `r na.omit(covidSA$tests) %>% max()`
  + Total Confirmed - `r na.omit(covidSA$confirmed) %>% max()`
  + Total Recovered - `r na.omit(covidSA$recovered) %>% max()`
  + Total Deaths - `r na.omit(covidSA$deaths) %>% max()`
  
* **A useful way to summarize data is by daily basis.** The following table explores the same.
  
```{r Daily}
nCovSA <- covidSA %>% select(date, tests, confirmed, recovered, deaths)

Daily <- nCovSA %>% mutate(lag_tests = lag(nCovSA$tests),
                  dailytest = (nCovSA$tests - lag_tests),
                  lag_confirm = lag(nCovSA$confirmed),
                  dailyconfirm = (nCovSA$confirmed - lag_confirm),
                  lag_recover = lag(nCovSA$recovered),
                  dailyrecover = (nCovSA$recovered - lag_recover),
                  lag_deaths = lag(nCovSA$deaths),
                  dailydeaths = (nCovSA$deaths - lag_deaths)) %>% 
  select(date, dailytest, dailyconfirm, dailyrecover, dailydeaths)
reactable(Daily, highlight = TRUE)
```

* The following tables show Summary Statistics of the above columns.

1. Mean Summaries:

```{r DailySummary}
kable(Daily %>% na.omit() %>% summarise(MeanTests = mean(dailytest),
                                  MeanConfirmed = mean(dailyconfirm),
                                  MeanRecovered = mean(dailyrecover),
                                  MeanDeaths = mean(dailydeaths))) %>%
  kable_styling(bootstrap_options = ("striped"), full_width = FALSE)
```

2. Minimum Summaries:

```{r}
kable(Daily %>% na.omit() %>% summarise(MinTests = min(dailytest),
                                  MinConfirmed = min(dailyconfirm),
                                  MinRecovered = min(dailyrecover),
                                  MinDeaths = min(dailydeaths))) %>%
  kable_styling(bootstrap_options = ("striped"), full_width = FALSE)
```

3. Maximum Summaries:

```{r}
kable(Daily %>% na.omit() %>% summarise(MaxTests = max(dailytest),
                                  MaxConfirmed = max(dailyconfirm),
                                  MaxRecovered = max(dailyrecover),
                                  MaxDeaths = max(dailydeaths))) %>%
  kable_styling(bootstrap_options = ("striped"), full_width = FALSE)
```



# **References -**

* Data Source - Guidotti, E., Ardia, D., (2020), "COVID-19 Data Hub", Journal of Open Source Software 5(51):2376, doi: 10.21105/joss.02376

* Data Tables - https://rstudio.github.io/DT/

* Reactable - https://glin.github.io/reactable/

* Wickham et al., (2019). Welcome to the tidyverse. Journal of Open Source Software,
  4(43), 1686, https://doi.org/10.21105/joss.01686

* Kirill MÃ¼ller (2017). here: A Simpler Way to Find Your Files. R package version 0.1.
  https://CRAN.R-project.org/package=here
  
* Greg Lin (2020). reactable: Interactive Data Tables Based on 'React Table'.
  https://glin.github.io/reactable/, https://github.com/glin/reactable.
  
* Yihui Xie, Joe Cheng and Xianying Tan (2020). DT: A Wrapper of the JavaScript Library
  'DataTables'. R package version 0.15. https://CRAN.R-project.org/package=DT
  
* Alboukadel Kassambara (2020). ggpubr: 'ggplot2' Based Publication Ready Plots. R
  package version 0.4.0. https://CRAN.R-project.org/package=ggpubr
  
* Hao Zhu (2019). kableExtra: Construct Complex Table with 'kable' and Pipe Syntax. R
  package version 1.1.0. https://CRAN.R-project.org/package=kableExtra